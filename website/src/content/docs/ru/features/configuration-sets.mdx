---
title: Конфигурационные наборы
description: Установка и управление повторно используемыми пакетами правил, навыков и MCP-серверов
---

import { Aside } from '@astrojs/starlight/components';

Конфигурационные наборы — это устанавливаемые, версионированные пакеты, объединяющие правила CLAUDE.md, навыки и конфигурации MCP-серверов. Они обеспечивают портативный способ обмена и повторного использования конфигураций Claude Code между проектами и командами.

## Обзор

Конфигурационный набор — это каталог, содержащий `manifest.json` (или `manifest.yaml`), который объявляет его компоненты:

```
my-set/
├── manifest.json
├── rules/
│   └── coding-standards.md
├── skills/
│   └── deploy.md
└── claude.md
```

## Схема манифеста

```json
{
  "name": "my-config-set",
  "version": "1.0.0",
  "description": "My team's coding standards and tools",
  "author": "team-name",
  "components": {
    "claude_md": {
      "path": "claude.md",
      "strategy": "append"
    },
    "rules": [
      {
        "name": "coding-standards",
        "path": "rules/coding-standards.md"
      }
    ],
    "skills": [
      {
        "name": "deploy",
        "path": "skills/deploy.md"
      }
    ],
    "mcp_servers": [
      {
        "name": "my-server",
        "server_type": "stdio",
        "command": "npx",
        "args": ["-y", "@myorg/mcp-server"],
        "env": {
          "API_KEY": "${MY_API_KEY}"
        }
      }
    ]
  },
  "env": [
    {
      "name": "MY_API_KEY",
      "description": "API key for the MCP server",
      "required": true
    }
  ]
}
```

### Валидация имени

Имена наборов должны соответствовать паттерну `^[a-z0-9][a-z0-9._-]*$`:
- Начинаться со строчной буквы или цифры
- Содержать только строчные буквы, цифры, точки, подчёркивания и дефисы

### Компоненты

| Компонент | Описание |
|-----------|---------|
| `claude_md` | Содержимое для слияния с CLAUDE.md проекта |
| `rules` | Файлы правил, устанавливаемые в `.claude/rules/` |
| `skills` | Определения навыков, устанавливаемые в `.claude/skills/` |
| `mcp_servers` | Конфигурации MCP-серверов, добавляемые в `.claude/settings.json` |

### Типы MCP-серверов

| Тип | Обязательные поля | Описание |
|-----|------------------|---------|
| `stdio` | `command` | Локальный процесс через stdin/stdout |
| `http` | `url` | Удалённый HTTP-сервер MCP |

```json
// stdio server
{
  "name": "local-tools",
  "server_type": "stdio",
  "command": "node",
  "args": ["./server.js"],
  "env": {"DEBUG": "true"}
}

// http server
{
  "name": "remote-api",
  "server_type": "http",
  "url": "https://mcp.example.com/api",
  "headers": {"Authorization": "Bearer ${TOKEN}"}
}
```

### Переменные окружения

Массив `env` объявляет обязательные или опциональные переменные окружения:

```json
{
  "env": [
    {
      "name": "API_KEY",
      "description": "API key for the service",
      "required": true
    },
    {
      "name": "DEBUG",
      "description": "Enable debug mode",
      "required": false,
      "default": "false"
    }
  ]
}
```

Переменные, указанные как `${VAR_NAME}` в конфигурациях MCP-серверов, разрешаются из окружения во время установки.

## Команды CLI

### Установка набора

```bash
claudex sets add ./path/to/set
```

Эта команда валидирует манифест, проверяет конфликты с существующими наборами и устанавливает все компоненты.

### Список установленных наборов

```bash
claudex sets list
```

Отображает все установленные наборы с их версией, описанием и количеством компонентов.

### Просмотр подробностей набора

```bash
claudex sets show <NAME>
```

Показывает подробную информацию об установленном наборе, включая все правила, навыки и MCP-серверы.

### Обновление набора

```bash
claudex sets update <NAME> ./path/to/new-version
```

Обновляет существующий набор до новой версии. Удаляет старые компоненты и устанавливает новые.

### Удаление набора

```bash
claudex sets remove <NAME>
```

Удаляет установленный набор и все его компоненты.

## Обнаружение конфликтов

При установке набора Claudex проверяет наличие конфликтов:

- **Конфликты имён правил**: два набора не могут устанавливать правила с одинаковым именем файла
- **Конфликты имён навыков**: два набора не могут устанавливать навыки с одинаковым именем
- **Конфликты MCP-серверов**: два набора не могут определять MCP-серверы с одинаковым именем

Если обнаружен конфликт, установка прерывается с описательным сообщением об ошибке, указывающим, какой существующий набор владеет конфликтующим компонентом.

## Файл блокировки

Установленные наборы отслеживаются в файле блокировки, который записывает:

- Имя и версию набора
- Пути установленных компонентов
- Временную метку установки

Это обеспечивает чистое удаление и обновление.
