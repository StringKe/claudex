---
title: 서킷 브레이커 & 장애 조치
description: 자동 장애 감지 및 제공자 장애 조치
---

Claudex는 각 제공자 프로파일에 대한 내장 서킷 브레이커를 포함하며, 장애가 감지되면 백업 제공자로 자동 장애 조치됩니다.

## 서킷 브레이커 상태

```
         성공
    ┌──────────────┐
    │              │
    ▼    실패      │
 Closed ────────► Open
    ▲              │
    │   타임아웃   │
    │   만료       ▼
    └─────────── HalfOpen
                   │
                실패 → Open으로 복귀
```

| 상태 | 동작 |
|-------|----------|
| **Closed** | 정상 작동. 요청이 통과됩니다. 실패 횟수가 카운트됩니다. |
| **Open** | 요청이 차단됩니다. 백업 제공자로의 장애 조치가 트리거됩니다. |
| **HalfOpen** | 복구 타임아웃 후, 하나의 프로브 요청이 허용됩니다. 성공 시 Closed로 전환; 실패 시 Open으로 복귀. |

## 기본 매개변수

| 매개변수 | 값 |
|-----------|-------|
| 실패 임계값 | 연속 3회 실패 |
| 복구 타임아웃 | 30초 |

## 장애 조치 설정

프로파일에 백업 제공자를 정의하여 자동 장애 조치를 활성화합니다:

```toml
[[profiles]]
name = "grok"
provider_type = "OpenAICompatible"
base_url = "https://api.x.ai/v1"
api_key = "xai-..."
default_model = "grok-3-beta"
backup_providers = ["deepseek", "chatgpt"]   # 장애 조치 체인
```

`grok`이 연속 3회 실패하면:
1. `grok`의 서킷 브레이커가 열림
2. `deepseek`으로 요청 재시도
3. `deepseek`도 실패하면 `chatgpt` 시도
4. 각 백업 제공자는 독립적인 서킷 브레이커를 가짐

## 상태 확인

백그라운드 상태 확인기가 약 30초마다 실행되어 활성화된 모든 프로파일에 경량 프로브 요청을 전송합니다. 상태는 TUI 대시보드에 색상 코드로 표시됩니다:

- 초록색: 정상
- 노란색: 저하됨 (최근 실패 있음)
- 빨간색: 서킷 브레이커 열림
